[Unit]
Description=Persisting persistent sysrepo datastores to /cfg
After=yang-startup.target
Requires=yang-startup.target

[Service]
Type=simple
UMask=0077
ExecStartPre=/bin/sh -c 'mkdir -p /cfg/sysrepo/ && sysrepocfg -d startup -f json -X > /cfg/sysrepo/startup.json'
ExecStart=/bin/sh -c 'while true; do inotifywait -e CLOSE_WRITE /etc/sysrepo/data/*.startup && sysrepocfg -d startup -f json -X > /cfg/sysrepo/startup.json; done'
Group=sysrepo
